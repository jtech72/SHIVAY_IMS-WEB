"use strict";(self.webpackChunkhyper_react=self.webpackChunkhyper_react||[]).push([[766],{9766:(e,l,s)=>{s.r(l),s.d(l,{default:()=>f});var d=s(5043),a=s(5009),i=s(6522),t=s(4282),n=s(1072),o=s(8602),c=s(8258),r=s(5449),u=s(423),p=s(3825),v=s(7196),h=s(6414),m=s(4556),x=s(9325),b=s(4858),j=s(5475),N=s(579);const f=()=>{var e,l,s,f,g,A,w,y,D;const[C]=(0,j.ok)(),S=C.get("id"),k=(0,m.wA)(),{handleSubmit:G,register:I,setValue:R}=(0,b.mN)(),[E,_]=(0,d.useState)(!1),L=(0,m.d4)((e=>e)),[q,O]=(0,d.useState)((new Date).toISOString().split("T")[0]),[P,W]=(0,d.useState)([]);console.log(P,"openingProducts");const F=null===L||void 0===L||null===(e=L.getDispatchDataReducer)||void 0===e||null===(l=e.dispatchList)||void 0===l?void 0:l.response;console.log(F,"DispatchData");const U=null===L||void 0===L||null===(s=L.getWarehouseListReducer)||void 0===s||null===(f=s.searchWarehouse)||void 0===f?void 0:f.response,V=null===L||void 0===L||null===(g=L.listingUsersReducer)||void 0===g||null===(A=g.listingUsers)||void 0===A?void 0:A.response,B=null===L||void 0===L||null===(w=L.listingCustomerReducer)||void 0===w||null===(y=w.listingCustomer)||void 0===y?void 0:y.response,Q=null===U||void 0===U?void 0:U.map((e=>({value:e._id,label:e.name}))),T=null===V||void 0===V?void 0:V.map((e=>({value:e._id,label:e.name}))),H=null===B||void 0===B?void 0:B.map((e=>({value:e._id,label:e.name}))),[K,M]=(0,d.useState)(null);console.log(K,"selectedWarehouse");const[J,Y]=(0,d.useState)(null),[z,X]=(0,d.useState)(null),[Z,$]=(0,d.useState)(!1),[ee,le]=(0,d.useState)(null),[se,de]=(0,d.useState)(!1),[ae,ie]=(0,d.useState)(""),te=(0,d.useRef)(null);console.log(ae,"editedQuantity");const ne=e=>{ie(e.target.value)},oe=e=>{"Enter"===e.key&&ce()};console.log(ee,"selectedStock34534r");const ce=()=>{de(!1)},re=()=>{de(!0)};(0,d.useEffect)((()=>{const e=e=>{te.current&&!te.current.contains(e.target)&&ce()};if(se)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[se]),(0,d.useEffect)((()=>{if(S&&(null===F||void 0===F?void 0:F.length)>0){const e=null===F||void 0===F?void 0:F.find((e=>e._id===S));le(e)}}),[S,F]),(0,d.useEffect)((()=>{if(S&&ee){var e,l,s,d,a,i,t,n;console.log(ee,"2345432"),O(null!==ee&&void 0!==ee&&ee.createdAt?new Date(null===ee||void 0===ee?void 0:ee.createdAt).toISOString().split("T")[0]:"");const o=null!==ee&&void 0!==ee&&ee.warehouseData?{value:ee.warehouseId,label:null===(e=ee.warehouseData)||void 0===e||null===(l=e.find((e=>(null===e||void 0===e?void 0:e._id)===(null===ee||void 0===ee?void 0:ee.warehouseId))))||void 0===l?void 0:l.name}:{};M(o);const c=null!==ee&&void 0!==ee&&ee.customerData?{value:null===ee||void 0===ee?void 0:ee.customerId,label:null===(s=ee.customerData)||void 0===s||null===(d=s.find((e=>(null===e||void 0===e?void 0:e._id)===(null===ee||void 0===ee?void 0:ee.customerId))))||void 0===d?void 0:d.name}:{};X(c);const r=null!==ee&&void 0!==ee&&ee.dispatchId?{value:null===ee||void 0===ee?void 0:ee.dispatchId,label:null===(a=ee.dispatchByData)||void 0===a||null===(i=a[0])||void 0===i?void 0:i.name}:{};Y(r),R("invoiceNumber",(null===ee||void 0===ee?void 0:ee.invoiceNumber)||""),R("description",(null===ee||void 0===ee?void 0:ee.description)||""),R("invoiceValue",(null===ee||void 0===ee?void 0:ee.fright)||""),R("attachmentGRfile",(null===ee||void 0===ee?void 0:ee.attachmentGRfile)||""),R("grNumber",(null===ee||void 0===ee?void 0:ee.grNumber)||""),ie((null===ee||void 0===ee||null===(t=ee.productData)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.stockOutQty)||"")}}),[S,ee]);(0,d.useEffect)((()=>{k((0,x.lo)())}),[k]),(0,d.useEffect)((()=>{k((0,x.GU)())}),[k]),(0,d.useEffect)((()=>{k((0,x.kW)())}),[k]);return(0,N.jsxs)("div",{children:[(0,N.jsx)(a.A,{breadCrumbItems:[{label:"SHIVAY Dispatch List",path:"/shivay/dispatch"},{label:"Add Dispatch ",path:"/shivay/dispatch",active:!0}],title:"Add Dispatch"}),(0,N.jsxs)(i.A,{onSubmit:G((e=>{var l;const s=P.map((e=>{let{product:l,...s}=e;return s})),d=new FormData;var a,i;((null===e||void 0===e||null===(l=e.attachmentGRfile)||void 0===l?void 0:l[0])instanceof File&&d.append("attachmentGRfile",e.attachmentGRfile[0]),d.append("warehouseId",null===K||void 0===K?void 0:K.value),d.append("dispatchBy",null===J||void 0===J?void 0:J.value),d.append("customerId",null===z||void 0===z?void 0:z.value),d.append("quantity",S?ae:JSON.stringify(s)),d.append("description",null===e||void 0===e?void 0:e.description),d.append("date",null===e||void 0===e?void 0:e.date),d.append("grNumber",null===e||void 0===e?void 0:e.grNumber),S)&&(d.append("_id",S),d.append("productId",null===ee||void 0===ee||null===(a=ee.productData)||void 0===a||null===(i=a[0])||void 0===i?void 0:i._id));k(S?(0,x.tw)(d):(0,x.KD)(d))})),children:[(0,N.jsx)("div",{className:"accordion mb-3",id:"accordionExample",children:(0,N.jsxs)("div",{className:"accordion-item",style:{border:"2px solid #6655D9"},children:[(0,N.jsx)("h2",{className:"accordion-header mt-0",children:(0,N.jsxs)("button",{className:"accordion-button py-1 d-flex justify-content-between align-items-center w-100",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":Z?"true":"false","aria-controls":"collapseOne",onClick:()=>{$((e=>!e))},children:[(0,N.jsx)("div",{className:"flex-grow-1 text-black fw-bold",children:" Add Dispatch Details"}),(0,N.jsx)("div",{className:"d-flex",children:(0,N.jsxs)(t.A,{className:"fw-bold custom-button me-2",onClick:()=>_(!0),disabled:!Z,children:[(0,N.jsx)(u.Hpy,{className:"fs-3"}),"\xa0Product"]})})]})}),(0,N.jsx)("div",{id:"collapseOne",className:"accordion-collapse collapse "+(Z?"show":""),"data-bs-parent":"#accordionExample",children:(0,N.jsx)("div",{className:"accordion-body py-1",children:(0,N.jsx)(i.A,{children:(0,N.jsxs)(n.A,{children:[(0,N.jsx)(o.A,{sm:3,children:(0,N.jsxs)(i.A.Group,{className:"mb-1",children:[(0,N.jsx)(i.A.Label,{className:"mb-0",children:"Warehouse"}),(0,N.jsx)(r.Ay,{value:K,onChange:e=>{M(e)},options:Q,placeholder:"Select a warehouse",isClearable:!0,required:!0})]})}),(0,N.jsx)(o.A,{sm:3,children:(0,N.jsxs)(i.A.Group,{className:"mb-1",children:[(0,N.jsx)(i.A.Label,{className:"mb-0",children:"Customer"}),(0,N.jsx)(r.Ay,{value:z,onChange:e=>{X(e)},options:H,placeholder:"Select a Customer",isClearable:!0,required:!0})]})}),(0,N.jsx)(o.A,{sm:3,children:(0,N.jsxs)(i.A.Group,{className:"mb-1",children:[(0,N.jsx)(i.A.Label,{className:"mb-0",children:"Dispatch By"}),(0,N.jsx)(r.Ay,{value:J,onChange:e=>{Y(e)},options:T,placeholder:"Select a User",isClearable:!0,required:!0})]})}),(0,N.jsx)(o.A,{sm:3,children:(0,N.jsxs)(i.A.Group,{className:"mb-1",children:[(0,N.jsx)(i.A.Label,{className:"mb-0",children:"Date Range"}),(0,N.jsx)(i.A.Control,{type:"date",defaultValue:q,...I("date",{required:!0}),required:!0})]})}),(0,N.jsx)(o.A,{sm:3,children:(0,N.jsxs)(i.A.Group,{className:"mb-1",children:[(0,N.jsx)(i.A.Label,{className:"mb-0",children:"GR Number"}),(0,N.jsx)(i.A.Control,{type:"text",placeholder:"Enter Invoice Number",...I("grNumber",{required:!0})})]})}),(0,N.jsx)(o.A,{sm:3,children:(0,N.jsxs)(i.A.Group,{className:"mb-1",children:[(0,N.jsx)(i.A.Label,{className:"mb-0",children:"Attach GR File"}),(0,N.jsx)(i.A.Control,{type:"file",placeholder:"Upload file",...I("attachmentGRfile",{required:!(null!==ee&&void 0!==ee&&ee.attachmentGRfile)})}),(null===ee||void 0===ee?void 0:ee.attachmentGRfile)&&(0,N.jsx)("div",{className:"mt-2",children:(0,N.jsx)("a",{href:ee.attachmentGRfile,target:"_blank",rel:"noopener noreferrer",children:"View Existing Invoice"})})]})}),(0,N.jsx)(o.A,{sm:6,children:(0,N.jsxs)(i.A.Group,{className:"mb-1",children:[(0,N.jsx)(i.A.Label,{className:"mb-0",children:"Description"}),(0,N.jsx)(i.A.Control,{as:"textarea",rows:1,placeholder:"Enter Description",...I("description",{required:!0})})]})})]})})})})]})}),(0,N.jsxs)("div",{className:"mt-2",children:[(0,N.jsx)(c.A,{style:{boxShadow:"rgba(50, 50, 93, 0.25) 0px 50px 100px -20px, rgba(0, 0, 0, 0.3) 0px 30px 60px -30px, rgba(10, 37, 64, 0.35) 0px -2px 6px 0px inset"},children:(0,N.jsx)(c.A.Body,{className:"text-center py-1",children:(0,N.jsxs)("table",{className:"table table-striped bg-white",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{className:"table_header",children:[(0,N.jsx)("th",{scope:"col",children:(0,N.jsx)("i",{className:"mdi mdi-merge"})}),(0,N.jsx)("th",{scope:"col",children:"Product Name"}),(0,N.jsx)("th",{scope:"col",children:"Modal"}),(0,N.jsx)("th",{scope:"col",children:"Code"}),(0,N.jsx)("th",{scope:"col",children:"Quantity"})]})}),!S&&(0,N.jsx)("tbody",{children:P&&P.length>0?P.map(((e,l)=>{var s,d,a,i;return(0,N.jsxs)("tr",{className:"text-dark fw-bold text-nowrap highlight-row",children:[(0,N.jsx)("th",{scope:"row",children:l+1}),(0,N.jsx)("td",{className:"text-uppercase fw-bold",children:(null===e||void 0===e||null===(s=e.product)||void 0===s?void 0:s.name)||(0,N.jsx)("span",{className:"text-danger",children:"N/A"})}),(0,N.jsx)("td",{className:"fw-bold",children:(null===e||void 0===e||null===(d=e.product)||void 0===d||null===(a=d.modelId)||void 0===a?void 0:a.name)||(0,N.jsx)("span",{className:"text-danger",children:"N/A"})}),(0,N.jsx)("td",{className:"fw-bold",children:(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.code)||(0,N.jsx)("span",{className:"text-danger",children:"N/A"})}),(0,N.jsx)("td",{className:"fw-bold",children:(null===e||void 0===e?void 0:e.quantity)||(0,N.jsx)("span",{className:"text-danger",children:"N/A"})}),(0,N.jsx)("td",{}),(0,N.jsxs)("div",{className:"icon-container d-flex pb-0",children:[(0,N.jsx)("span",{className:"icon-wrapper",title:"Edit",children:(0,N.jsx)(p.dtF,{className:"fs-4 text-black",style:{cursor:"pointer"}})}),(0,N.jsx)("span",{className:"icon-wrapper",title:"Delete",children:(0,N.jsx)(v.WFf,{className:"fs-4 text-black",style:{cursor:"pointer"}})})]})]},l)})):(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"6",className:"text-center text-muted py-3",children:"No products added yet. Please add products to add dispatch."})})}),S&&(0,N.jsx)("tbody",{children:null===ee||void 0===ee||null===(D=ee.productData)||void 0===D?void 0:D.map(((e,l)=>{var s,d;return(0,N.jsxs)("tr",{className:"text-dark fw-bold text-nowrap highlight-row",children:[(0,N.jsx)("td",{children:l+1}),(0,N.jsx)("td",{children:null===e||void 0===e?void 0:e.name}),(0,N.jsx)("td",{children:null===ee||void 0===ee||null===(s=ee.modelData)||void 0===s||null===(d=s.find((l=>(null===l||void 0===l?void 0:l._id)===(null===e||void 0===e?void 0:e.modelId))))||void 0===d?void 0:d.name}),(0,N.jsx)("td",{children:null===e||void 0===e?void 0:e.code}),(0,N.jsx)("td",{children:se?(0,N.jsx)("input",{ref:te,type:"number",value:ae,onChange:ne,onKeyPress:oe,className:"form-control form-control-md",style:{width:"5vw",display:"inline-block",marginTop:"-10px"}}):(0,N.jsxs)("span",{onClick:re,children:[" ",ae]})||(0,N.jsx)("span",{className:"text-black",children:"-"})}),(0,N.jsx)("div",{className:"icon-container d-flex pb-0",children:(0,N.jsx)("span",{className:"icon-wrapper me-4",title:"Edit",onClick:re,children:(0,N.jsx)(p.dtF,{className:"fs-4 text-black",style:{cursor:"pointer"}})})})]},l)}))})]})})}),(0,N.jsxs)("div",{className:"text-end",children:[(0,N.jsx)(t.A,{className:"fw-bold cancel-button me-2",children:"Cancel"}),(0,N.jsx)(t.A,{className:"fw-bold custom-button",type:"submit",children:"Submit"})]})]})]}),(0,N.jsx)(h.A,{selectedWarehouse:K,openingProducts:P,setOpeningProducts:W,showModal:E,handleClose:()=>_(!1)})]})}}}]);
//# sourceMappingURL=766.05fbb4ff.chunk.js.map